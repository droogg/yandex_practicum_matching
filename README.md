# yandex_practicum_matching
Проект "Мэтчинг товаров маркетплейса"

## Описание
Этот проект разработан для демонстрации возможностей матчинга данных с использованием машинного обучения и библиотеки Faiss. Цель проекта - создать эффективный инструмент для поиска ближайших соседей в больших наборах данных.   

Проект включает в себя REST API, разработанный на FastAPI, который позволяет пользователям отправлять запросы и получать результаты матчинга, а также Jupyter Notebook, который демонстрирует весь процесс исследования, от анализа данных до разработки и тестирования модели.

## Постановка задачи
Задача проекта - разработать и исследовать модель для эффективного поиска ближайших соседей в многомерном пространстве. Модель должна обеспечивать высокую скорость обработки запросов и точность результатов, что важно для решения широкого спектра задач, от рекомендательных систем до классификации данных.

## Исследования и Результаты
В ходе исследований мы провели анализ различных подходов и алгоритмов, в том числе использование методов уменьшения размерности и квантизации. Результаты показали, что оптимальная конфигурация модели обеспечивает высокую точность и скорость поиска. Jupyter Notebook включает в себя подробные описания экспериментов, визуализации и анализ результатов.


## Технологии
- Python
- FastAPI
- Faiss
- Jupyter Notebook
- Pandas
- NumPy
- scikit-learn

## Установка и настройка
Для работы с проектом необходимо установить следующие зависимости:

```pip install fastapi uvicorn faiss-cpu numpy pandas jupyter```

**Запуск сервера FastAPI:**

```uvicorn server:app --host 127.0.0.1 --port 8000 --reload```


**Как использовать:**

Для использования REST API отправьте POST-запрос на http://127.0.0.1:8000/find_neighbors/ с JSON-телом, содержащим образец данных для поиска. В ответе вы получите список меток ближайших соседей.

**Пример запроса:**

```
import requests

url = "http://127.0.0.1:8000/find_neighbors/"
data = {"sample": sample}
response = requests.post(url, json=data)
print(response.json())

```

---
Проект содержит скрипты в ```./server_matching/``` :

- *create_index.py* - формирование индексов FAISS, скейлер, модель PCA_matrix на новых данных. Сформированные объекты сохраняются в папке ```server_matching/model/```  

- *server.py* - Rest API приложение, написанное на FastAPI

- *client.py* - пример направления запроса на Rest API сервер, для получения 5-ки ближайших соседей (наиболее схожих товаров). 

---
P.S. файл индексов ```index.faiss``` - имеет большой вес (~ 750 Мб). В репозиторий его не выкладываю. Необходимо использовать *create_index.py* для его создания.
